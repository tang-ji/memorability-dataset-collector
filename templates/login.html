<!DOCTYPE html>
<html class="no-js">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>Start</title>
		<link rel="stylesheet" type="text/css" href="static/css/normalize.css" />
		<link rel="stylesheet" type="text/css" href="static/css/component.css" />
		<style type="text/css">
			body {
				background: #f9f7f6;
				color: #404d5b;
				margin: auto;
				font-weight: 200;
				font-size: 1.05em;
				font-family: 'Raleway', Arial, sans-serif;
			}
			*, *:after, *:before { -webkit-box-sizing: border-box; box-sizing: border-box; }
			.clearfix:before, .clearfix:after { content: ''; display: table; }
			.clearfix:after { clear: both; }

			.content {
				font-size: 150%;
				padding: 1em 0;
			}

			.content p {
				margin: 1em 0;
				padding: 5em 0 0 0;
				font-size: 0.65em;
			}
			.modal-header {
				padding: 4px 16px;
				background-color: #aaa;
				color: black;
			}
			.modal-body {
				padding: 2px 16px;
				background-color: #f9f7f6;
			}
			.modal {
				display: none; /* Hidden by default */
				position: fixed; /* Stay in place */
				z-index: 1; /* Sit on top */
				left: 0;
				top: 0;
				width: 100%; /* Full width */
				height: 100%; /* Full height */
				overflow: auto; /* Enable scroll if needed */
				background-color: rgb(0,0,0); /* Fallback color */
				background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
			}
			.modal-content {
				position: left;
				background-color: #fefefe;
				margin: auto;
				margin-top: 100px;
				padding: 0;
				border: 1px solid #888;
				width: 50%;
				box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2),0 6px 20px 0 rgba(0,0,0,0.19);
				animation-name: animatetop;
				animation-duration: 0.4s
			}
			/* Add Animation */
			@keyframes animatetop {
			from {top: -300px; opacity: 0}
			to {top: 0; opacity: 1}
			}
			.container{
				max-width: 600px;
				height: 200px;
				padding: 20px 0;
				text-align: center;
				margin: 0 auto;
			}
			.content p {
				margin: 0em 0;
				padding: 1em 0 0 0;
				font-size: 0.65em;
			}
			.container h1{
				font-size: 65px;
				font-weight: 300;
				padding: -50px 0;
				text-align: center;
			}
			.container h2{
				font-size: 22px;
				font-weight: 150;
				padding: -50px 0;
				font-family: consolas;
				text-align: center;
			}
			.container h3{
				font-size: 18px;
				font-weight: 150;
				font-family: consolas;
				text-align: center;
			}
			.container l2{
				text-align: center;
				font-weight: 200;
				font-size: 1.05em;
				font-family: Courier;
				white-space: pre;
			}
			.container l1{
				font-size: 28px;
				font-weight: 300;
				text-align: center;
				font-family: consolas;
			}
			form button{
				background: #404d5b;
				border: 0;
				padding: 5px 15px;
				color: white;
				border-radius: 8px;
				width: 250px;
				font-size: 30px;
				align: center;
			}
			form button:hover{
				background:#CCC;
			}
			.select {
				position: relative;
				width: 80%;
				padding: 8px 14px;
				margin: 1em;
				max-width: 200px;
				border-radius: 6px;
				width: calc(80% - 5em);
				background-color: #f1f1f1;
				align-items: right;
			}

			kbd {
				background-color: #eee;
				border-radius: 3px;
				border: 1px solid #b4b4b4;
				box-shadow: 0 1px 1px rgba(0,0,0,.2), 0 2px 0 0 rgba(255,255,255,.7) inset;
				color: #333;
				display: inline-block;
				font-family: consolas,"Liberation Mono",courier,monospace;
				font-size: .85em;
				font-weight: 700;
				line-height: 1;
				padding: 2px 4px;
				white-space: nowrap;
			}
			.close {
				color: #aaa;
				float: right;
				font-size: 28px;
				font-weight: bold;
			}
			.close:hover,
			.close:focus {
				color: black;
				text-decoration: none;
				cursor: pointer;
			}
		
		</style>
	</head>
	<body>
		<script src="static/js/jquery-3.5.1.min.js"></script>
			<div class="container">
				<section class="content">
					<div id="model_leaderboard" class="modal">
						<div class="modal-content">
							<div class="modal-header">
								<span id="close_board" class="close">&times;</span>
								<l1>Leaderboard</l1>
							</div>
							<div class="modal-body">
								<label id="board"></label>
								<p></p><p></p>
							</div>
						</div>
					</div>
					<form action="/login" method="POST">
					<img src="static/logo_accenture.png" width="300">
					<h1><p>Image Memory Game</p></h1>
						<span class="input input--ichiro">
							<input class="input__field input__field--ichiro" type="text" id="nickname" name="username" onkeypress="return event.keyCode != 13;"/>
							<label class="input__label input__label--ichiro" for="nickname">
								<span class="input__label-content input__label-content--ichiro">Nickname</span>
							</label>
						</span>
						<h2>Press <kbd>N</kbd> to generate a random Nickname. </h2>
						<button type="button" id="start">Start</button>
						<h3>Press <kbd>L</kbd> to see current leaderboard. </h3>
					<div id="model_login" class="modal">
						<div class="modal-content">
							<div class="modal-header">
								<span id="close_login" class="close">&times;</span>
								<l1>Login</l1>
							</div>
							<div class="modal-body">
								<h3><label id="welcome"></label></h3>
								<h3>(If it's not you, please change another nickname)</h3>
								<div id="new_user">
									<div id="question_sex"><h2>Sex:
										<select id="sex" name="sex">
										<option value="M">M.</option>
										<option value="F">F.</option>
										<option value="Other">Other</option>
										<option value="None">I don't want to reply</option>
										</select></h2>
									</div>
									<div id="question_age"><h2>Age:
										<select id="age" name="age">
										<option value="<20"><20</option>
										<option value="20-30">20-30</option>
										<option value="30-40">30-40</option>
										<option value="40-50">40-50</option>
										<option value="50-60">50-60</option>
										<option value=">60">>60</option>
										<option value="None">I don't want to reply</option>
										</select></h2>
									</div>
									<div id="question_job"><h2>Job:
										<select id="job" name="job">
										<option value="Engineering">Engineering</option>
										<option value="Finance">Finance</option>
										<option value="Healthcare">Healthcare</option>
										<option value="Hospitality">Hospitality</option>
										<option value="Technology">Technology</option>
										<option value="Transportation">Transportation</option>
										<option value="Other">Other</option>
										<option value="None">I don't want to reply</option>
										</select></h2>
									</div>
									<div id="question_ethnic"><h2>Location:
										<select id="ethnic" name="ethnic">
										<option value="Africa">Africa</option>
										<option value="Asia">Asia</option>
										<option value="Europe">Europe</option>
										<option value="North America">North America</option>
										<option value="South America">South America</option>
										<option value="Oceania">Oceania</option>
										<option value="None">I don't want to reply</option>
										</select></h2>
									</div>
								</div>
								<h3>Please keep your nickname in mind if you want to play more.</h3>
								<form action="" method="get">
								<button id="submit">Confirm</button></p>
								</form>	
							</div>

							
						</div>
					</div>
					</form>
				</section>
			</div>
			<script src="static/js/classie.js"></script>
			<script>
				(function() {
					if (!String.prototype.trim) {
						(function() {
							var rtrim = /^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;
							String.prototype.trim = function() {
								return this.replace(rtrim, '');
							};
						})();
					}

					[].slice.call( document.querySelectorAll( 'input.input__field' ) ).forEach( function( inputEl ) {
						if( inputEl.value.trim() !== '' ) {
							classie.add( inputEl.parentNode, 'input--filled' );
						}

						inputEl.addEventListener( 'focus', onInputFocus );
						inputEl.addEventListener( 'blur', onInputBlur );
					} );

					function onInputFocus( ev ) {
						classie.add( ev.target.parentNode, 'input--filled' );
					}

					function onInputBlur( ev ) {
						if( ev.target.value.trim() === '' ) {
							classie.remove( ev.target.parentNode, 'input--filled' );
						}
					}
				})();
			</script>
	</body>
<script type=text/javascript>
	$SCRIPT_ROOT = {{ request.script_root|tojson|safe }};
	var model_leaderboard = document.getElementById("model_leaderboard");
	var model_login = document.getElementById("model_login");
	var span = document.getElementsByClassName("close")[0];
	var board = {{board | tojson}};
	document.getElementById("board").innerHTML = board;
	document.getElementById("start").style.background = "#CCC";
	document.getElementById("new_user").style.visibility = "hidden";
	document.getElementById("new_user").style.height = "8px";

	document.getElementById("close_board").onclick = function() {
		model_leaderboard.style.display = "none";
	}
	document.getElementById("close_login").onclick = function() {
		model_login.style.display = "none";
	}
	document.getElementById("start").onclick = function() {
		if (document.getElementById("nickname").value.length > 1 && document.getElementById("nickname").value.length < 20) {
			model_leaderboard.style.display = "none";
			$.getJSON($SCRIPT_ROOT + '/get_info', {username: document.getElementById("nickname").value}, function(data){
				document.getElementById("welcome").innerHTML = data.info["welcome"];
				if (data.info["no_info"]) {
					document.getElementById("new_user").style.visibility = "visible";
					document.getElementById("new_user").style.height = "auto";
				}
				else {
					document.getElementById("new_user").style.visibility = "hidden";
					document.getElementById("new_user").style.height = "8px";
				}
			});
			model_login.style.display = "block";
			document.getElementById("submit").focus();
		}
	}

	let mouse_on_input = false;
	window.onclick = function(event) {
		if (event.target == model_leaderboard) {
			model_leaderboard.style.display = "none";
		}
		if (event.target == model_login) {
			model_login.style.display = "none";
		}
		if (event.target == document.getElementById("nickname")) {
			mouse_on_input = true;
			model_leaderboard.style.display = "none";
			model_login.style.display = "none";
		}
		else mouse_on_input = false;
	}
	
	document.body.onkeyup = function(e){
		if (document.getElementById("nickname").value.length > 1 && document.getElementById("nickname").value.length < 20) {
			document.getElementById("start").style.background = "#404d5b";
		}
		else document.getElementById("start").style.background = "#CCC";

		// Enter button
		if (e.keyCode==13 && document.getElementById("nickname").value.length > 1 && document.getElementById("nickname").value.length < 20){
			model_leaderboard.style.display = "none";
			$.getJSON($SCRIPT_ROOT + '/get_info', {username: document.getElementById("nickname").value}, function(data){
				document.getElementById("welcome").innerHTML = data.info["welcome"];
				if (data.info["no_info"]) {
					document.getElementById("new_user").style.visibility = "visible";
					document.getElementById("new_user").style.height = "auto";
				}
				else {
					document.getElementById("new_user").style.visibility = "hidden";
					document.getElementById("new_user").style.height = "8px";
				}
			});
			model_login.style.display = "block";
			document.getElementById("submit").focus();
		}
		if (e.keyCode==76 && !mouse_on_input){
			model_login.style.display = "none";
			model_leaderboard.style.display = "block";
		}
		if (e.keyCode==78 && !mouse_on_input){
			$.getJSON($SCRIPT_ROOT + '/get_nickname', {}, 
				function(data) {document.getElementById("nickname").value = data.nickname;
				document.getElementById("start").style.background = "#404d5b";
				document.querySelectorAll( 'input.input__field' ).forEach( function( inputEl ) {
					classie.add( inputEl.parentNode, 'input--filled' );
				});
			});
		}
	}
</script>